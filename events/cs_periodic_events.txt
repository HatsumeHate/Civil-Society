
namespace = civilsocietyperiodic


# REFUGEE GATE
country_event = {

	id = civilsocietyperiodic.1
	
	is_triggered_only = yes
	hide_window = yes
	
	
	trigger = {
		is_country_type = default
		#always = no
	}
	
	
	immediate = {
		every_owned_planet = {
			limit = {
				exists = owner
				num_pops > 5
				has_ground_combat = no
				has_owner = yes
				has_planet_flag = civil_disturbance_flag
					OR = {
						has_planet_flag = civil_disturbance_level_3
						has_planet_flag = civil_disturbance_level_4
						has_planet_flag = civil_disturbance_level_5
					}
				NOT = { has_modifier = civil_resettlment_blockade } 
				NOT = { has_planet_flag = civil_resettlment_cooldown_flag } 
			}
			
			#log = "civil society: refugee startup"

			random_list = {
				2 = {
					modifier = {
						factor = 2
						has_planet_flag = civil_disturbance_level_3
					}
					modifier = {
						factor = 3
						has_planet_flag = civil_disturbance_level_4
					}
					modifier = {
						factor = 4
						has_planet_flag = civil_disturbance_level_5
					}
					
					log = "civil society: refugee triggered at [this.GetName]"
					planet_event = { id = civilsocietyperiodic.2 }
				
				}
				90 = {
					modifier = {
						add = 30
						has_planet_flag = cs_tickets_flag
					}
					modifier = {
						add = 50
						has_global_flag = resolution_cs_galactic_refugee_programm_active
						#is_active_resolution = resolution_cs_galactic_refugee_programm
					}

				}
			}
		}
	}
}


# REFUGEES EVENT
planet_event = {

	id = civilsocietyperiodic.2
	
	title = "civilsocietyperiodic.2.name"
	desc = "civilsocietyperiodic.2.desc"
	picture = GFX_evt_busy_spaceport
	show_sound = event_ship_thrusters
	location = this
	

	is_triggered_only = yes
	
	
	immediate = {
		set_variable = { which = max_pop value = 1 }
		set_variable = { which = seed_amount value = 2 }
					
		random_list = {
			2 = { set_variable = { which = max_pop value = 2 } }
			3 = { set_variable = { which = max_pop value = 1 } }
		}
	
		set_variable = { which = total_transported value = 1 }
					
		log = "civil society: refugee process start at [root.GetName]"

		while = {
			limit = {
				num_pops > 5
				check_variable = {
					which = max_pop
					value > 0
				}
				check_variable = {
					which = seed_amount
					value > 0
				}
			}

				random_owned_pop = {
					weights = {
						base = 1
						modifier = {
							add = 1
							has_trait = trait_nomadic
						}
						modifier = {
							add = 2
							happiness < 0.35
						}
						modifier = {
							add = 1
							happiness <= 0.5
						}
						modifier = {
							add = 2
							is_unemployed = yes
						}
						modifier = {
							mult = 0
							pop_cant_flee = yes
						}
					}
					
					#save_event_target_as = refugee_pop
					#refugee_pop_effect = yes
					#pop_event = { id = refugees.4 }

					prev = {
						subtract_variable = { which = max_pop value = 1 }
						change_variable = { which = total_transported value = 1 }
					}
				}
				subtract_variable = { which = seed_amount value = 1 }
				#set_timed_planet_flag = { flag = civil_resettlment_cooldown_flag months = @civil_resettlment_cooldown_duration }
		}

		log = "civil society: refugee processed at [root.GetName]"


		clear_variable = max_pop
		clear_variable = seed_amount

		subtract_variable = { which = total_transported value = 1 }


		if = {
			limit = {
				check_variable = {
					which = total_transported
					value = 2
				}
			}
			set_variable = {
				which = cost
				value = 125
			}
			set_variable = {
				which = society_blank
				value = 300
			}
		}
		else = {
			set_variable = {
				which = cost
				value = 75
			}
			set_variable = {
				which = society_blank
				value = 150
			}
		}

	}


	after = {
		hidden_effect = {

			log = "civil society: refugee effect preparing"
			if = {
				limit = {
					NOT = {
						has_modifier = civil_resettlment_blockade 
					}
					check_variable = {
						which = total_transported
						value > 0
					}
				}	
				log = "civil society: refugee effect start"

				while = {
					count = total_transported

					random_owned_pop = {
						weights = {
							base = 1
							modifier = {
								add = 1
								has_trait = trait_nomadic
							}
							modifier = {
								add = 2
								happiness < 0.35
							}
							modifier = {
								add = 1
								happiness <= 0.5
							}
							modifier = {
								add = 2
								is_unemployed = yes
							}
							modifier = {
								mult = 0
								pop_cant_flee = yes
							}
						}
						remove_modifier = civil_strike
						save_event_target_as = refugee_pop
						refugee_pop_effect = yes
					}
				}

				log = "civil society: refugee effect end"
				set_timed_planet_flag = { flag = civil_resettlment_cooldown_flag months = @civil_resettlment_cooldown_duration }
			}

			clear_variable = total_transported
			clear_variable = cost
			clear_variable = society_blank
		}
	}
	

	option = {
		name = civilsocietyperiodic.2.gen
		custom_tooltip = civilsocietyperiodic.2.tooltip
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				has_modifier = civil_strike_pm
			}
		}
	}
	option = {
		name = civilsocietyperiodic.2.a
		custom_tooltip = civilsocietyperiodic.2.tooltip
		trigger = {
			owner = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.2.mil
		custom_tooltip = civilsocietyperiodic.2.tooltip
		trigger = {
			owner = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.2.mat
		custom_tooltip = civilsocietyperiodic.2.tooltip
		custom_tooltip = civilsocietyperiodic.2.mat_tooltip
		trigger = {
			owner = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
			}
		}
		hidden_effect = {
			owner = {
				add_resource = {
					society_research  = 150
				}
			}
			if = {
				limit = {
					check_variable = {
						which = total_transported
						value = 2
					}
				}
				owner = {
					add_resource = {
						society_research  = 150
					}
				}
			}
		}
		ai_chance = {
			factor = 2
		}
	}
	option = {
		name = civilsocietyperiodic.2.eg
		custom_tooltip = civilsocietyperiodic.2.tooltip

		trigger = {
			owner = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
			}
		}

		custom_tooltip = civilsocietyperiodic.2.eg_tooltip

		hidden_effect = {

			set_timed_planet_flag = {
				flag = cs_tickets_flag
				days = 360
			}

			owner = {
				add_resource = {
					energy = 75
				}
			}

			if = {
				limit = {
					check_variable = {
						which = total_transported
						value = 2
					}
				}
				owner = {
					add_resource = {
						energy = 75
					}
				}
			}

		}

		ai_chance = {
			factor = 2
		}
	}
	# option = {
	# 	name = civilsocietyperiodic.2.pc
	# 	trigger = {
	# 		owner = {
	# 			NOT = { has_policy_flag = resettlement_not_allowed }
	# 		}
	# 	}
	# }
	option = {
		name = civilsocietyperiodic.2.x
		trigger = {
			owner = {
				has_policy_flag = resettlement_not_allowed
			}
		}
		add_modifier = { 
			modifier = "civil_resettlment_blockade" 
			months = @civil_society_blockade_duration 
		}
		ai_chance = {
			factor = 3
		}
	}
}

# ПЕРЕДЕЛАТЬ СРАБАТЫВАНИЕ
# RAID EVENT
country_event = {

	id = civilsocietyperiodic.3
	
	is_triggered_only = yes
	hide_window = yes
	
	
	trigger = {
		is_country_type = default
		any_owned_planet = {
			has_modifier = civil_raid
		}
	}

	
	immediate = {
		every_owned_planet = {
			limit = {
				exists = owner
				num_pops > 5
				has_ground_combat = no
				has_owner = yes
				has_modifier = civil_raid
				NOT = { has_planet_flag = civil_raid_cooldown_flag }
			}

			random_list = {
				50 = {
						
					random_owned_pop = {
						weights = {
							base = 1
							modifier = {
								add = 2
								NOR = { 
									has_ethic = ethic_militarist 
									has_ethic = ethic_authoritarian
								}
							}
							modifier = {
								add = 2
								happiness <= 0.5
							}
							modifier = {
								add = 3
								happiness <= 0.35
							}
							modifier = {
								add = 4
								happiness <= 0.25
							}
							modifier = {
								add = 2
								is_unemployed = yes
							}
							modifier = {
								mult = 0
								pop_cant_flee = yes
							}
						}
						
						log = "civil society: raid triggered at [root.GetName]"

						remove_modifier = civil_strike


						save_event_target_as = refugee_pop
						refugee_pop_effect = yes
						#pop_event = { id = refugees.4 }

						prev = {

							set_timed_planet_flag = { 
								flag = civil_raid_cooldown_flag
								months = @civil_raid_cooldown_duration
							}

							every_owned_pop = {
								limit = {
									OR = {
										is_authoritarian = yes
										is_militarist = yes
									}
									is_enslaved = no
									pop_has_happiness = yes
								}
								add_modifier = {
									modifier = civil_pop_exiled
									months = 24
								}
							}
							
						}
					}
						
				
				}
				50 = {
				
				}
			}
		}
	}
}


# PLANETARY DESTRUCTIONS
country_event = {

	id = civilsocietyperiodic.4
	
	is_triggered_only = yes
	hide_window = yes
	
	
	trigger = {
		is_country_type = default
		any_owned_planet = {
			has_planet_flag = civil_disturbance_flag
		}
	}
	
	
	immediate = {
		every_owned_planet = {
			limit = {
				exists = owner
				is_colony = yes
				has_ground_combat = no
				has_planet_flag = civil_disturbance_flag
					OR = {
						has_planet_flag = civil_disturbance_level_3
						has_planet_flag = civil_disturbance_level_4
						has_planet_flag = civil_disturbance_level_5
					}
				NOT = { has_planet_flag = civil_devastation_flag }
			}

			log = "civil society: destructions triggered on [this.GetName]"

			random_list = {
				15 = {
					modifier = {
						has_modifier = civil_damage_control
						add = -10
					}
					modifier = {
						has_planet_flag = cs_police_control_flag
						add = -10
					}
					modifier = {
						add = 5
						has_planet_flag = civil_disturbance_level_3
					}
					modifier = {
						add = 10
						has_planet_flag = civil_disturbance_level_4
					}
					modifier = {
						add = 15
						has_planet_flag = civil_disturbance_level_5
					}
					modifier = {
						add = 15
						has_modifier = civil_planet_radicals
					}

					random_list = {
						2 = {
							modifier = {
								factor = 0
								num_districts = {
									type = any
									value = 0
								}
							}

							switch = {
								trigger = is_planet_class
								pc_habitat = {

									random_list = {
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_hab_commercial }
													has_modifier = civil_trade_hab_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.12 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_hab_cultural }
													has_modifier = civil_leisure_hab_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.13 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_hab_energy }
													has_modifier = civil_energy_hab_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.14 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_hab_housing }
													has_modifier = civil_housing_hab_district_devastations 
												}
											}
											planet_event = { id = civilsocietyperiodic.15 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_hab_mining }
													has_modifier = civil_mining_hab_district_devastations 
												}
											}
											planet_event = { id = civilsocietyperiodic.16 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_hab_science }
													has_modifier = civil_research_hab_district_devastations 
												}
											}
											planet_event = { id = civilsocietyperiodic.17 }
										}
									}

								}
								# pc_city = {
								# 	random_list = {
								# 		1 = {
								# 			modifier = {
								# 				factor = 0
								# 				OR = {
								# 					NOT = { has_district = district_arcology_housing }
								# 					has_modifier = civil_city_ringworld_district_devastations
								# 				}
								# 			}
								# 			planet_event = { id = civilsocietyperiodic.18 }
								# 		}
								# 	}
								# }
								pc_ringworld_habitable = {

									random_list = {
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_rw_city }
													has_modifier = civil_city_ringworld_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.18 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_rw_commercial }
													has_modifier = civil_city_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.19 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_rw_farming }
													has_modifier = civil_farming_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.20 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_rw_generator }
													has_modifier = civil_energy_district_devastations 
												}
											}
											planet_event = { id = civilsocietyperiodic.21 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_rw_science }
													has_modifier = civil_energy_district_devastations 
												}
											}
											planet_event = { id = civilsocietyperiodic.22 }
										}
									}
										
								}
								default = {
										
									random_list = {
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_mining }
													has_modifier = civil_mining_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.8 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_industrial }
													has_modifier = civil_industrial_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.26 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_city }
													has_modifier = civil_city_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.9 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_farming }
													has_modifier = civil_farming_district_devastations
												}
											}
											planet_event = { id = civilsocietyperiodic.10 }
										}
										1 = {
											modifier = {
												factor = 0
												OR = {
													NOT = { has_district = district_generator }
													has_modifier = civil_energy_district_devastations 
												}
											}
											planet_event = { id = civilsocietyperiodic.11 }
										}
									}

								}
							}

						}
						5 = {
							random_list = {
								3 = { 
									planet_event = { id = civilsocietyperiodic.5 }
								}
								2 = { 
									planet_event = { id = civilsocietyperiodic.6 }
								}
								1 = {
									planet_event = { id = civilsocietyperiodic.7 }
								}
							}
							
							set_timed_planet_flag = {
								flag = civil_devastation_flag
								months = @civil_devastation_flag_duration
							}
						}
					}

				}
				205 = { }
			}

		}
	}
}


# LIGHT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.5
	title = "civilsocietyperiodic.5.name"
	desc = "civilsocietyperiodic.5.desc"
	picture = GFX_evt_night_raid
	show_sound = event_air_raid_siren
	location = this

	is_triggered_only = yes	

	immediate = {
		add_planet_devastation = 10
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_planet_devastation = 10
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 100 }
			}
		}
		owner = {
			add_resource = {
				minerals = -100
			}
		}
		tooltip = {
			add_planet_devastation = 5	
		}
		hidden_effect = {
			add_planet_devastation = -5
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 400
					}
				}
			}
		}
	}
	
}

# MEDIUM DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.6
	title = "civilsocietyperiodic.6.name"
	desc = "civilsocietyperiodic.6.desc"
	picture = GFX_evt_night_raid
	show_sound = event_air_raid_siren
	location = this

	is_triggered_only = yes	

	immediate = {
		add_planet_devastation = 15
		random_list = {
			50 = {
				random_owned_pop = {
					limit = {
						is_sapient = yes
					}
					kill_pop = yes
				}
			}
			50 = {

			}
		}
	}

	after = {
		custom_tooltip = civilsocietyperiodic.6.tooltip
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_planet_devastation = 15
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 200 }
			}
		}
		owner = {
			add_resource = {
				minerals = -200
			}
		}
		tooltip = {
			add_planet_devastation = 8
		}
		hidden_effect = {
			add_planet_devastation = -7
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 500
					}
				}
			}
		}
	}
	
}

# HEAVY DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.7
	title = "civilsocietyperiodic.7.name"
	desc = "civilsocietyperiodic.7.desc"
	picture = GFX_evt_night_raid
	show_sound = event_air_raid_siren
	location = this

	is_triggered_only = yes	


	immediate = {
		add_planet_devastation = 20

		while = {
			count = 2
			random_owned_pop = {
				limit = {
					is_sapient = yes
				}
				random_list = {
					50 = {
						kill_pop = yes
					}
					50 = {

					}
				}
			}
		}
	}

	after = {
		custom_tooltip = civilsocietyperiodic.7.tooltip
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_planet_devastation = 20
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}

		owner = {
			add_resource = {
				minerals = -500
			}
		}
		add_planet_devastation = -10

		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}

# MINING DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.8
	title = "civilsocietyperiodic.8.name"
	desc = "civilsocietyperiodic.8.desc"
	picture = GFX_evt_night_raid
	show_sound = event_structural_collapse
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = "civil_mining_district_devastations"
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}


	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = "civil_mining_district_devastations"
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = "civil_mining_district_devastations"
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = "civil_mining_district_devastations"
			add_modifier = {
				modifier = "civil_mining_district_devastations"
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}

}


# CITY DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.9
	title = "civilsocietyperiodic.9.name"
	desc = "civilsocietyperiodic.9.desc"
	picture = GFX_evt_night_raid
	show_sound = event_ground_battle
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = "civil_city_district_devastations"
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = "civil_city_district_devastations"
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = "civil_city_district_devastations"
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = "civil_city_district_devastations"
			add_modifier = {
				modifier = "civil_city_district_devastations"
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}

}


# FOOD DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.10
	title = "civilsocietyperiodic.10.name"
	desc = "civilsocietyperiodic.10.desc"
	picture = GFX_evt_night_raid
	show_sound = event_planetary_riot
	location = this

	is_triggered_only = yes

	immediate = {
		add_modifier = {
			modifier = "civil_farming_district_devastations"
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = "civil_farming_district_devastations"
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = "civil_farming_district_devastations"
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = "civil_farming_district_devastations"
			add_modifier = {
				modifier = "civil_farming_district_devastations"
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}

}


# INDUSTRIAL DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.26
	title = "civilsocietyperiodic.26.name"
	desc = "civilsocietyperiodic.26.desc"
	picture = GFX_evt_night_raid
	show_sound = event_planetary_riot
	location = this

	is_triggered_only = yes

	immediate = {
		add_modifier = {
			modifier = civil_industrial_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_industrial_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_industrial_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_industrial_district_devastations
			add_modifier = {
				modifier = civil_industrial_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}

}


# ENERGY DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.11
	title = "civilsocietyperiodic.11.name"
	desc = "civilsocietyperiodic.11.desc"
	picture = GFX_evt_night_raid
	show_sound = event_super_explosion
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = "civil_energy_district_devastations"
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = "civil_energy_district_devastations"
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = "civil_energy_district_devastations"
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = "civil_energy_district_devastations"
			add_modifier = {
				modifier = "civil_energy_district_devastations"
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# HABITAT COMMERCIAL DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.12
	title = civilsocietyperiodic.12.name
	desc = civilsocietyperiodic.12.desc
	picture = GFX_evt_cs_habitat
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_trade_hab_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_trade_hab_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_trade_hab_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_trade_hab_district_devastations
			add_modifier = {
				modifier = civil_trade_hab_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# HABITAT LEISURE DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.13
	title = civilsocietyperiodic.13.name
	desc = civilsocietyperiodic.13.desc
	picture = GFX_evt_cs_habitat
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_leisure_hab_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_leisure_hab_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_leisure_hab_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_leisure_hab_district_devastations
			add_modifier = {
				modifier = civil_leisure_hab_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# HABITAT ENERGY DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.14
	title = civilsocietyperiodic.14.name
	desc = civilsocietyperiodic.14.desc
	picture = GFX_evt_cs_habitat
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_energy_hab_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_energy_hab_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_energy_hab_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_energy_hab_district_devastations
			add_modifier = {
				modifier = civil_energy_hab_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# HABITAT HOUSING DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.15
	title = civilsocietyperiodic.15.name
	desc = civilsocietyperiodic.15.desc
	picture = GFX_evt_cs_habitat
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_housing_hab_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_housing_hab_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_housing_hab_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_housing_hab_district_devastations
			add_modifier = {
				modifier = civil_housing_hab_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# HABITAT MINING DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.16
	title = civilsocietyperiodic.16.name
	desc = civilsocietyperiodic.16.desc
	picture = GFX_evt_cs_habitat
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_mining_hab_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_mining_hab_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_mining_hab_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_mining_hab_district_devastations
			add_modifier = {
				modifier = civil_mining_hab_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# HABITAT SCIENCE DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.17
	title = civilsocietyperiodic.17.name
	desc = civilsocietyperiodic.17.desc
	picture = GFX_evt_cs_habitat
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_research_hab_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_research_hab_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_research_hab_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_research_hab_district_devastations
			add_modifier = {
				modifier = civil_research_hab_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# RINGWORLD CITY DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.18
	title = civilsocietyperiodic.18.name
	desc = civilsocietyperiodic.18.desc
	picture = GFX_evt_ringworld
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_city_ringworld_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_city_ringworld_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		tooltip = {
			add_modifier = {
				modifier = civil_city_ringworld_district_devastations
				months = 7
			}
		}
		hidden_effect = {
			remove_modifier = civil_city_ringworld_district_devastations
			add_modifier = {
				modifier = civil_city_ringworld_district_devastations
				months = 7
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# RINGWORLD COMMERCIAL DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.19
	title = civilsocietyperiodic.19.name
	desc = civilsocietyperiodic.19.desc
	picture = GFX_evt_ringworld
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_commercial_ringworld_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_commercial_ringworld_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		hidden_effect = {
			remove_modifier = civil_commercial_ringworld_district_devastations
		}
		add_modifier = {
			modifier = civil_commercial_ringworld_district_devastations
			months = 7
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# RINGWORLD FARMING DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.20
	title = civilsocietyperiodic.20.name
	desc = civilsocietyperiodic.20.desc
	picture = GFX_evt_ringworld
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_farming_ringworld_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_farming_ringworld_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		hidden_effect = {
			remove_modifier = civil_farming_ringworld_district_devastations
		}
		add_modifier = {
			modifier = civil_farming_ringworld_district_devastations
			months = 7
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# RINGWORLD RESEARCH DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.21
	title = civilsocietyperiodic.21.name
	desc = civilsocietyperiodic.21.desc
	picture = GFX_evt_ringworld
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_research_ringworld_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_research_ringworld_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		hidden_effect = {
			remove_modifier = civil_research_ringworld_district_devastations
		}
		add_modifier = {
			modifier = civil_research_ringworld_district_devastations
			months = 7
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}


# RINGWORLD ENERGY DISTRICT DEVASTATION
planet_event = {
	
	id = civilsocietyperiodic.22
	title = civilsocietyperiodic.22.name
	desc = civilsocietyperiodic.22.desc
	picture = GFX_evt_ringworld
	show_sound = event_public_unrest
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_energy_ringworld_district_devastations
			months = 12
		}
		set_timed_planet_flag = {
			flag = civil_devastation_flag
			months = @civil_devastation_flag_duration
		}
	}

	option = {
		name = civilsocietyperiodic.5.gen
		tooltip = {
			add_modifier = {
				modifier = civil_energy_ringworld_district_devastations
				months = 12
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.5.x
		allow = {
			owner = {
				has_resource = { type = minerals amount >= 500 }
			}
		}
		owner = {
			add_resource = {
				minerals = -500
			}
		}
		hidden_effect = {
			remove_modifier = civil_energy_ringworld_district_devastations
		}
		add_modifier = {
			modifier = civil_energy_ringworld_district_devastations
			months = 7
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				owner = {
					has_resource = { 
						type = minerals
						amount >= 700
					}
				}
			}
		}
	}
	
}



# HABITAT LEAK HAPPENED
planet_event = {
	
	id = civilsocietyperiodic.23
	title = civilsocietyperiodic.23.name
	desc = civilsocietyperiodic.23.desc
	picture = GFX_evt_sabotaged_ship
	show_sound = event_yellow_alert
	location = this

	is_triggered_only = yes	

	immediate = {
		add_modifier = {
			modifier = civil_habitat_leaked
		}
		enable_some_special_project_owner = {
			PROJECT = CS_HABITAT_DAMAGED
			WHERE = this
			OWNER = owner
		}
	}

	option = {
		name = civilsocietyperiodic.23.gen
		tooltip = {
			add_modifier = {
				modifier = civil_habitat_leaked
			}
			enable_special_project = {
				name = CS_HABITAT_DAMAGED
				location = this
			}
		}
		ai_chance = {
			factor = 1
		}
	}
	
}



# HABITAT LEAK FIXED
planet_event = {
	
	id = civilsocietyperiodic.24
	title = civilsocietyperiodic.24.name
	desc = civilsocietyperiodic.24.desc
	picture = GFX_evt_space_walk
	show_sound = event_construction
	location = this

	is_triggered_only = yes	

	immediate = {
		remove_modifier = civil_habitat_leaked
	}

	option = {
		name = civilsocietyperiodic.24.gen
		tooltip = {
			remove_modifier = civil_habitat_leaked
		}
		ai_chance = {
			factor = 1
		}
	}
	
}


# HABITAT LEAK FAILURE
planet_event = {
	
	id = civilsocietyperiodic.25
	title = civilsocietyperiodic.25.name
	desc = {
		text = civilsocietyperiodic.25.desc
		trigger = {
			has_modifier = civil_habitat_catastrophic_echo
		}
	}
	desc = {
		text = civilsocietyperiodic.25.desc_special
		trigger = {
			NOT = { has_modifier = civil_habitat_catastrophic_echo }
		}
	}
	picture = GFX_evt_sabotaged_ship
	show_sound = event_ship_explosion
	location = this
	is_triggered_only = yes	


	after = {
		remove_modifier = civil_habitat_leaked
	}

	immediate = {

		if = {
			limit = { 
				count_owned_pop = {
					limit = { is_robot_pop = no }
					count > 0
				}
			}
			remove_modifier = civil_habitat_catastrophic_echo
			add_modifier = {
				modifier = civil_habitat_catastrophic_echo
				years = 5
			}
			every_owned_pop = {
				limit = {
					is_robot_pop = no
				}
				kill_pop = yes
			}
		}
		else = {
			while = {
				count = 2
				random_owned_pop = {
					kill_pop = yes
				}
			}
		}
	}

	option = {
		name = civilsocietyperiodic.25.gen
		trigger = {
			has_modifier = civil_habitat_catastrophic_echo
		}
		tooltip = {
			add_modifier = {
				modifier = civil_habitat_catastrophic_echo
				years = 5
			}
		}
		custom_tooltip = civilsocietyperiodic.25.tooltip
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = civilsocietyperiodic.25.gen_special
		trigger = {
			NOT = { has_modifier = civil_habitat_catastrophic_echo }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = 2
				min = 500
				max = 1500
			}
		}
		custom_tooltip = civilsocietyperiodic.25.tooltip_special
		ai_chance = {
			factor = 1
		}
	}
	
}